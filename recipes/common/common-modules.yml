modules:
    - type: containerfile
      snippets:
        - COPY --from=ghcr.io/ublue-os/akmods:main-43 /rpms /tmp/rpms
        - COPY --from=ghcr.io/ublue-os/akmods:main-43 /kernel-rpms /tmp/rpms/kernel
        - RUN find /tmp/rpms
        - RUN rpm -q ublue-os-akmods-addons || dnf install -y /tmp/rpms/ublue-os/ublue-os-akmods-addons*.rpm
    - type: script
      scripts:
        - installsignedkernel.sh

    - type: dnf
      install:
        install-weak-deps: false
        packages:
          - just
          - powerstat

    - type: dnf
      repos:
        files:
          - https://copr.fedorainfracloud.org/coprs/ublue-os/packages/repo/fedora-%OS_VERSION%/ublue-os-packages-fedora-%OS_VERSION%.repo
      install:
        install-weak-deps: false
        packages:
          - ublue-os-udev-rules
          - ublue-os-update-services
          - ublue-os-signing
          - ublue-os-luks
          - ublue-os-just

    - type: script
      scripts:
        - installandroidudev.sh
        - ensureautoupdates.sh
        - addimageinfo.sh

    - type: dnf
      install:
        install-weak-deps: false
        packages:
        # launcher
          - rofi-wayland
          - wofi

        # environment
          - dbus-daemon
          - dbus-tools
          - ddcutil
          - distrobox
          - fprintd-pam
          - fzf
          - gnome-disk-utility
          - google-noto-emoji-fonts
          - headsetcontrol
          - mediainfo 
          - openssl
          - p7zip
          - playerctl
          - polkit
          - qt5-qtwayland
          - qt6-qtwayland
          - steam-devices
          - tuned-ppd
          - vim
          - vulkan-tools
          - vulkan-validation-layers
          - wl-clipboard
          - xdg-user-dirs
          - xfce-polkit
          - xorg-x11-server-Xwayland
          
        # sound
          - alsa-firmware
          - alsa-plugins-pulseaudio
          - pamixer
          - pavucontrol
          - pulseaudio-utils
          - wireplumber

        # networking
          - blueman
          - bluez
          - bluez-tools
          - firewall-config
          - network-manager-applet
          - NetworkManager-openconnect
          - NetworkManager-openconnect-gnome
          - NetworkManager-openvpn
          - NetworkManager-openvpn-gnome
          - nm-connection-editor

        # file manager
          - android-tools
          - gtkhash-thunar
          - gvfs-archive
          - gvfs-fuse
          - gvfs-gphoto2
          - gvfs-mtp
          - gvfs-nfs
          - gvfs-smb
          - imv
          - thunar
          - thunar-archive-plugin 
          - thunar-volman
          - xarchiver

        # screenshot
          - grim
          - slurp

        # display
          - brightnessctl
          - kanshi
          - light
          - wlr-randr
          - wlsunset

        # notifications
          - dunst

        # theme and GUI
          - breeze-icon-theme
          - fontawesome-fonts-all
          - gnome-icon-theme
          - gnome-themes-extra
          - paper-icon-theme
          - papirus-icon-theme
      replace:
        - from-repo: fedora
          packages:
            - old: OpenCL-ICD-Loader
              new: ocl-icd

    - from-file: common/proprietary-modules.yml

    - type: script
      scripts:
        - removeunusedrepos.sh

    - type: files
      files:
        - source: system/usr
          destination: /usr
        - source: system/etc
          destination: /etc

    - type: gschema-overrides
      include:
        - zz1-toxicblue-theming.gschema.override

    - type: toxicblue-signing
      source: local
